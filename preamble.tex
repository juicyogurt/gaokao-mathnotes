% 页面大小
\usepackage{geometry}
\geometry{b5paper,centering,scale=0.8}

%页眉页脚
\usepackage{fancyhdr}
\fancyhf{}
\fancyhead[LE]{\ntsrbold\thepage}
\fancyhead[RE]{\textbf{\rightmark}}
\fancyhead[RO]{\ntsrbold\thepage}
\fancyhead[LO]{\ntsrbold\boxed{\textbf{github.com/juicyogurt/gaokao-mathnotes}}}
\renewcommand{\headrulewidth}{0pt}
\pagestyle{fancy}
\renewcommand\chaptermark[1]{%
  \markright{\CTEXifname{\CTEXthechapter}{}#1}
}
\setlength{\headheight}{13pt}

%章节标题
\ctexset{
  chapter = {
    format      = \huge\bfseries\centering,
    nameformat  = {},
    number      = \ntsrbold\arabic{chapter},
    name        = {第,章},
    aftername   = \quad,
    beforeskip  = 30pt,
    afterskip   = 40pt,
    pagestyle   = empty,
  },
  section = {
    format      = \Large\bfseries\raggedright,
    number      = \ntsrbold\boxed{\textbf{\arabic{chapter}.\arabic{section}}},
    aftername   = \quad,
    beforeskip  = 25pt,
    afterskip   = 15pt,
  },
  subsection = {
    format      = \large\bfseries\raggedright,
    indent      = 2em, 
    beforeskip  = 15pt,
    afterskip   = 10pt,
  }
}

% 字体
\usepackage{fontspec}
\usepackage{amsmath}
\usepackage{unicode-math}
\everymath{\displaystyle}
\setCJKmainfont[Mapping = fullwidth-stop,
  BoldFont={Source Han Serif SC Bold}]
  {Source Han Serif SC}
\setCJKsansfont[Mapping = fullwidth-stop,
  BoldFont={Source Han Sans SC}]
  {得意黑}
\newfontfamily\ntsrbold{Source Han Serif SC Bold}
\xeCJKsetup{CJKmath=true}

% 列表
\usepackage{enumitem}
\setlist[itemize]{leftmargin=0pt, nosep}

% 图片
\usepackage{graphicx}

% 测试用文本
\usepackage{zhlipsum}

% 子文件独立编译
\usepackage{subfiles}

% 颜色
\usepackage{tcolorbox}
\definecolor{frame}{HTML}{e0e0e0}

% 定理
\tcbuselibrary{most}
\newtcolorbox{theorem}[2][]{
  enhanced,breakable,
  left=12pt,right=12pt,
  fonttitle=\bfseries,
  coltitle=black,
  colbacktitle=frame,
  attach boxed title to top left={yshifttext=-1mm},
  boxed title style={skin=enhancedfirst jigsaw,arc=1mm,bottom=0mm,boxrule=0mm},
  boxrule=1pt,
  colback=white,
  colframe=frame,
  sharp corners,
  title=\vspace{3mm}#2,
  arc=1mm,#1
}

% 问题
\usepackage{newtxtext}
\usepackage[dvipsnames,svgnames]{xcolor}
\usepackage[strict]{changepage}
\usepackage{framed}
\newenvironment{problem}{%
  \def\FrameCommand{%
    \hspace{1pt}%
    {\color{frame}\vrule width 2pt}%
    {\color{white}\vrule width 4pt}%
    \colorbox{white}%
  }%
  \MakeFramed{\advance\hsize-\width\FrameRestore}%
  \noindent\hspace{-4.55pt}%
  \begin{adjustwidth}{}{7pt}%
  \vspace{2pt}\vspace{2pt}%
}%
{%
  \vspace{2pt}\end{adjustwidth}\endMakeFramed%
}%

% 拓展
\newtcolorbox{extension}[2][]{
  fonttitle=\bfseries,
  title=#2,
  colback=white,
  coltitle=black,
  colframe=frame,#1
}